# 网关支付

::: tip 提示
网关支付功能需要配合支付网关前端进行使用，生成的网关支付链接，都需要通过支付网关前端进行展示。所有要使用网关支付，必须要部署运营支付网关前端。

:::
## 功能介绍

### 公共配置
> 用于处理各种通用的参数和商户小程序快捷支付相关的配置，要使用网关支付相关的功能，这个配置是必须的。
#### 参数说明

| 参数              | 功能                                      |
|-----------------|-----------------------------------------|
| 同时显示聚合收银码       | PC收银台在展示的时候是否额外展示聚合收银的二维码，方便客户直接扫码进行支付  |
| H5收银台自动升级聚合支付   | 如果使用微信支付宝一类软件访问H5收银台链接时，是切换为聚合支付的方式进行支付 |
| 小程序快捷收银开启分账     | 订单是否允许分账，开启后订单会被设置为可分账订单                |
| 小程序快捷收银自动分账     | 是否自动对支付订单进行分账                           |
| 小程序快捷收银限制用户支付类型 | 小程序使用快捷收款时限制不可以使用哪些方式                   |
| 小程序关联终端号        | 部分通道付款码支付的时候要求上送终端设备信息, 所以需要选择默认的收款终端设备 |

### PC收银台配置
> PC收银台配置的格式为有多个分账，每个分组下有多个配置项，分组配置比较简单，此处只说明配置项的参数

#### 参数说明
| 参数     | 功能                       |
|--------|--------------------------|
| 名称     | 当前支付项的名称                 |
| 调用方式   | 发起支付时调用的方式，见下方`调用方式说明`章节 |
| 支付通道   |                          |
| 支付方式   |                          |
| 其他支付方式 | 支付方式为其他方式时，需要填写此字段       |
| 是否推荐   | 该支付项是否添加推荐图标             |
| 显示图标   |                          |
| 排序     | 数值小的在前面，类型为浮点值           |


### H5收银台配置
> H5收银台配置与PC收银台配置方式相同，区别在于H5收银台只可以配置一个分组，PC收银台可以多个分组。

### 聚合支付配置
> 创建聚合支付行为时会生成一个链接，这个链接使用不同的支付软件访问会使用对应配置的方式来调起支付，从而实现同时支持微信、支付宝等软件的支付。

#### 参数说明

| 参数         | 功能                                                  |
|------------|-----------------------------------------------------|
| 聚合支付类型     | 所处的支付场景，分为微信、支付宝、银联三大类，不可重复设置                       |
| 支付通道       |                                                     |
| 支付方式       |                                                     |
| 其他支付方式     | 支付方式为其他方式时，需要填写此字段                                  |
| 调用方式       | 发起支付时调用的方式，见下方`调用方式说明`章节                            |
| 自动拉起支付     | 开启会自动进行拉起支付操作，关闭后需要手动拉起支付操作                         |
| 需要获取OpenId | 公众号或小程序一类的的支付需要使用OpenId，开启后进入页面会先进行认证授权的操作来获取OpenId |
### 付款码支付配置
> 通过识别付款码的类型，然后根据配置选择对应的通道和支付方式进行支付，来实现扫码任意付款码都可以进行收银操作。

#### 参数说明

| 参数     | 功能                      |
|--------|-------------------------|
| 付款码类型  | 主要分为微信、支付宝、银联三大类，不可重复设置 |
| 支付通道   |                         |
| 支付方式   |                         |
| 其他支付方式 | 支付方式为其他方式时，需要填写此字段      |

### 收款码牌配置
> 码牌本质上是一个链接地址，用户扫描码牌后会跳转到支付页面，输入要支付的金额后就可以进行支付。

> 类似聚合支付，通过对不同支付场景进行配置，从而实现同时支持微信、支付宝等软件的支付操作。
#### 码牌参数说明

| 参数       | 功能                       |
|----------|--------------------------|
| 码牌名称     | 码牌的名称，会在收银界面进行显示         |
| 是否启用     |                          |
| 开启分账     | 订单是否允许分账，开启后订单会被设置为可分账订单 |
| 自动分账     | 是否自动对支付订单进行分账            |
| 限制用户支付类型 | 小程序使用快捷收款时限制不可以使用哪些方式    |

#### 配置项参数说明

| 参数       | 功能                                                  |
|----------|-----------------------------------------------------|
| 码牌类型     | 所处的支付场景，分为微信、支付宝两类，不可重复设置                           |
| 支付通道     |                                                     |
| 支付方式     |                                                     |
| 其他支付方式   | 支付方式为其他方式时，需要填写此字段                                  |
| 调用方式     | 发起支付时调用的方式，见下方`调用方式说明`章节                            |
| 获取OpenId | 公众号或小程序一类的的支付需要使用OpenId，开启后进入页面会先进行认证授权的操作来获取OpenId |

### 调用方式说明
::: tip 说明
在进行网关配置时，多数都需要进行调用方式配置，不同的调用方式，在进行支付操作的时候，会有不同的行为，我们需要根据支付通道、支付方式、以及业务场景选择合适的调用方式
:::


| 参数    | 功能                                                              |
|-------|-----------------------------------------------------------------|
| 扫码支付  | 将发起支付使用的链接生成二维码，让用户扫码进行支付，通常只会用在PC收银台中                          |
| 条码支付  | 弹出跳码输入创建，让用户输入支付码进行支付， 通常只会用在PC收银台中，但使用概率极低，此场景直接使用付款码支付更合适     |
| 跳转链接  | 使用频率最高的一种调用方式，无论是收银台、聚合支付，还是码牌支付，都是使用此调用方式，这种方式会直接跳转支付链接进行发起支付。 |
| 小程序   | 跳转到小程序收银台进行支付，目前尚未支持                                            |
| APP支付 | 跳转到APP进行支付，目前尚未支持                                               |
| JSAPI | 主要为公众号和小程序使用的支付方式，通过返回的json对象来拉起支付收银台                           |
| 表单方式  | 有些通道支付时是需要通过表单提交的方式拉起支付支付，如银联支付                                 |

> **注意：多数通道的二维码支付都是返回的一个链接，在码牌、聚合支付、H5收银台中通常直接使用这种调用方式，而不是扫码支付调用方式**

## 操作截图

### 公共配置

![wechat_2025-05-05_101415_831](https://cdn.jsdmirror.com/gh/xxm1995/picx-images-hosting@master/20250505/wechat_2025-05-05_101415_831.175lj28imr.webp)

### 收银台配置

![wechat_2025-05-05_101542_240](https://cdn.jsdmirror.com/gh/xxm1995/picx-images-hosting@master/20250505/wechat_2025-05-05_101542_240.2rvcij6ya6.webp)

![wechat_2025-05-05_101517_000](https://cdn.jsdmirror.com/gh/xxm1995/picx-images-hosting@master/20250505/wechat_2025-05-05_101517_000.8dx2we893h.webp)

<img src="https://cdn.jsdmirror.com/gh/xxm1995/picx-images-hosting@master/20250427/wechat_2025-04-27_203920_863.7phv2q931.webp" alt="wechat_2025-04-27_203920_863" />

<img src="https://cdn.jsdmirror.com/gh/xxm1995/picx-images-hosting@master/20250427/wechat_2025-04-27_204208_069.6bh9xisxha.webp" alt="wechat_2025-04-27_204208_069" width = "270" height = "570" />

### 聚合支付配置

![wechat_2025-05-05_101618_013](https://cdn.jsdmirror.com/gh/xxm1995/picx-images-hosting@master/20250505/wechat_2025-05-05_101618_013.6wqxun5p3x.webp)

### 付款码支付配置

![wechat_2025-05-05_101635_170](https://cdn.jsdmirror.com/gh/xxm1995/picx-images-hosting@master/20250505/wechat_2025-05-05_101635_170.lvxwrh8zg.webp)

### 收款码牌配置

![wechat_2025-05-05_101731_864](https://cdn.jsdmirror.com/gh/xxm1995/picx-images-hosting@master/20250505/wechat_2025-05-05_101731_864.6f0w624p8d.webp)

![wechat_2025-05-05_101750_828](https://cdn.jsdmirror.com/gh/xxm1995/picx-images-hosting@master/20250505/wechat_2025-05-05_101750_828.4xur4b0khq.webp)

<img alt="7604af26dde4add3ff9aaea7a7d3be84" src="https://cdn.jsdmirror.com/gh/xxm1995/picx-images-hosting@master/20250427/7604af26dde4add3ff9aaea7a7d3be84.7axdaovomy.webp"  width = "270" height = "570" />

<img src="https://cdn.jsdmirror.com/gh/xxm1995/picx-images-hosting@master/20250427/1b7671d183f279751460d42234c6eadb.2rvc7pq7p4.webp" alt="1b7671d183f279751460d42234c6eadb"  width = "270" height = "570" />
